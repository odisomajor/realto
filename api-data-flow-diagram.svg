<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #1e40af; }
      .section-title { font: bold 16px sans-serif; fill: #374151; }
      .endpoint-title { font: bold 12px sans-serif; fill: #1f2937; }
      .method-get { font: bold 10px sans-serif; fill: #059669; }
      .method-post { font: bold 10px sans-serif; fill: #dc2626; }
      .method-put { font: bold 10px sans-serif; fill: #d97706; }
      .method-delete { font: bold 10px sans-serif; fill: #7c2d12; }
      .text { font: 10px sans-serif; fill: #4b5563; }
      .small-text { font: 9px sans-serif; fill: #6b7280; }
      .frontend-box { fill: #dbeafe; stroke: #2563eb; stroke-width: 2; }
      .backend-box { fill: #dcfce7; stroke: #22c55e; stroke-width: 2; }
      .database-box { fill: #fef3c7; stroke: #f59e0b; stroke-width: 2; }
      .endpoint-box { fill: #f8fafc; stroke: #cbd5e1; stroke-width: 1; }
      .get-line { stroke: #059669; stroke-width: 2; }
      .post-line { stroke: #dc2626; stroke-width: 2; }
      .put-line { stroke: #d97706; stroke-width: 2; }
      .delete-line { stroke: #7c2d12; stroke-width: 2; }
      .data-flow { stroke: #6366f1; stroke-width: 2; stroke-dasharray: 5,5; }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#374151"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="title">API Endpoints & Data Flow Architecture</text>
  
  <!-- Frontend Section -->
  <rect x="50" y="60" width="500" height="800" class="frontend-box" rx="10"/>
  <text x="300" y="85" text-anchor="middle" class="section-title">Frontend API Calls</text>
  
  <!-- Authentication API Calls -->
  <rect x="70" y="100" width="220" height="180" class="endpoint-box" rx="5"/>
  <text x="180" y="115" text-anchor="middle" class="endpoint-title">Authentication</text>
  
  <text x="80" y="135" class="method-post">POST</text>
  <text x="110" y="135" class="text">/api/auth/login</text>
  <text x="80" y="150" class="method-post">POST</text>
  <text x="110" y="150" class="text">/api/auth/register</text>
  <text x="80" y="165" class="method-post">POST</text>
  <text x="110" y="165" class="text">/api/auth/logout</text>
  <text x="80" y="180" class="method-post">POST</text>
  <text x="110" y="180" class="text">/api/auth/refresh</text>
  <text x="80" y="195" class="method-post">POST</text>
  <text x="110" y="195" class="text">/api/auth/forgot-password</text>
  <text x="80" y="210" class="method-post">POST</text>
  <text x="110" y="210" class="text">/api/auth/reset-password</text>
  <text x="80" y="225" class="method-post">POST</text>
  <text x="110" y="225" class="text">/api/auth/verify-email</text>
  <text x="80" y="240" class="method-get">GET</text>
  <text x="110" y="240" class="text">/api/auth/me</text>
  <text x="80" y="255" class="method-post">POST</text>
  <text x="110" y="255" class="text">/api/auth/2fa/setup</text>
  <text x="80" y="270" class="method-post">POST</text>
  <text x="110" y="270" class="text">/api/auth/2fa/verify</text>
  
  <!-- Property API Calls -->
  <rect x="310" y="100" width="220" height="280" class="endpoint-box" rx="5"/>
  <text x="420" y="115" text-anchor="middle" class="endpoint-title">Properties</text>
  
  <text x="320" y="135" class="method-get">GET</text>
  <text x="350" y="135" class="text">/api/properties</text>
  <text x="320" y="150" class="method-get">GET</text>
  <text x="350" y="150" class="text">/api/properties/:id</text>
  <text x="320" y="165" class="method-post">POST</text>
  <text x="350" y="165" class="text">/api/properties</text>
  <text x="320" y="180" class="method-put">PUT</text>
  <text x="350" y="180" class="text">/api/properties/:id</text>
  <text x="320" y="195" class="method-delete">DEL</text>
  <text x="350" y="195" class="text">/api/properties/:id</text>
  <text x="320" y="210" class="method-get">GET</text>
  <text x="350" y="210" class="text">/api/properties/search</text>
  <text x="320" y="225" class="method-get">GET</text>
  <text x="350" y="225" class="text">/api/properties/featured</text>
  <text x="320" y="240" class="method-get">GET</text>
  <text x="350" y="240" class="text">/api/properties/similar/:id</text>
  <text x="320" y="255" class="method-post">POST</text>
  <text x="350" y="255" class="text">/api/properties/:id/images</text>
  <text x="320" y="270" class="method-get">GET</text>
  <text x="350" y="270" class="text">/api/properties/analytics</text>
  <text x="320" y="285" class="method-post">POST</text>
  <text x="350" y="285" class="text">/api/properties/:id/view</text>
  <text x="320" y="300" class="method-get">GET</text>
  <text x="350" y="300" class="text">/api/properties/recommendations</text>
  <text x="320" y="315" class="method-post">POST</text>
  <text x="350" y="315" class="text">/api/properties/bulk-update</text>
  <text x="320" y="330" class="method-get">GET</text>
  <text x="350" y="330" class="text">/api/properties/market-insights</text>
  <text x="320" y="345" class="method-post">POST</text>
  <text x="350" y="345" class="text">/api/properties/:id/tour</text>
  <text x="320" y="360" class="method-get">GET</text>
  <text x="350" y="360" class="text">/api/properties/mortgage-calc</text>
  
  <!-- User API Calls -->
  <rect x="70" y="300" width="220" height="200" class="endpoint-box" rx="5"/>
  <text x="180" y="315" text-anchor="middle" class="endpoint-title">User Management</text>
  
  <text x="80" y="335" class="method-get">GET</text>
  <text x="110" y="335" class="text">/api/users/profile</text>
  <text x="80" y="350" class="method-put">PUT</text>
  <text x="110" y="350" class="text">/api/users/profile</text>
  <text x="80" y="365" class="method-post">POST</text>
  <text x="110" y="365" class="text">/api/users/avatar</text>
  <text x="80" y="380" class="method-get">GET</text>
  <text x="110" y="380" class="text">/api/users/dashboard</text>
  <text x="80" y="395" class="method-get">GET</text>
  <text x="110" y="395" class="text">/api/users/properties</text>
  <text x="80" y="410" class="method-get">GET</text>
  <text x="110" y="410" class="text">/api/users/browsing-history</text>
  <text x="80" y="425" class="method-post">POST</text>
  <text x="110" y="425" class="text">/api/users/change-password</text>
  <text x="80" y="440" class="method-delete">DEL</text>
  <text x="110" y="440" class="text">/api/users/account</text>
  <text x="80" y="455" class="method-get">GET</text>
  <text x="110" y="455" class="text">/api/users/notifications</text>
  <text x="80" y="470" class="method-put">PUT</text>
  <text x="110" y="470" class="text">/api/users/preferences</text>
  
  <!-- Favorites & Interactions -->
  <rect x="70" y="520" width="220" height="140" class="endpoint-box" rx="5"/>
  <text x="180" y="535" text-anchor="middle" class="endpoint-title">Favorites & Interactions</text>
  
  <text x="80" y="555" class="method-get">GET</text>
  <text x="110" y="555" class="text">/api/favorites</text>
  <text x="80" y="570" class="method-post">POST</text>
  <text x="110" y="570" class="text">/api/favorites/:propertyId</text>
  <text x="80" y="585" class="method-delete">DEL</text>
  <text x="110" y="585" class="text">/api/favorites/:propertyId</text>
  <text x="80" y="600" class="method-post">POST</text>
  <text x="110" y="600" class="text">/api/inquiries</text>
  <text x="80" y="615" class="method-get">GET</text>
  <text x="110" y="615" class="text">/api/inquiries</text>
  <text x="80" y="630" class="method-post">POST</text>
  <text x="110" y="630" class="text">/api/contact</text>
  <text x="80" y="645" class="method-get">GET</text>
  <text x="110" y="645" class="text">/api/saved-searches</text>
  
  <!-- Additional Services -->
  <rect x="310" y="400" width="220" height="160" class="endpoint-box" rx="5"/>
  <text x="420" y="415" text-anchor="middle" class="endpoint-title">Additional Services</text>
  
  <text x="320" y="435" class="method-get">GET</text>
  <text x="350" y="435" class="text">/api/agents</text>
  <text x="320" y="450" class="method-get">GET</text>
  <text x="350" y="450" class="text">/api/agents/:id</text>
  <text x="320" y="465" class="method-post">POST</text>
  <text x="350" y="465" class="text">/api/files/upload</text>
  <text x="320" y="480" class="method-get">GET</text>
  <text x="350" y="480" class="text">/api/geocoding/address</text>
  <text x="320" y="495" class="method-get">GET</text>
  <text x="350" y="495" class="text">/api/notifications</text>
  <text x="320" y="510" class="method-post">POST</text>
  <text x="350" y="510" class="text">/api/notifications/subscribe</text>
  <text x="320" y="525" class="method-get">GET</text>
  <text x="350" y="525" class="text">/api/browsing-sessions</text>
  <text x="320" y="540" class="method-post">POST</text>
  <text x="350" y="540" class="text">/api/analytics/track</text>
  
  <!-- Real-time Features -->
  <rect x="70" y="680" width="460" height="100" class="endpoint-box" rx="5"/>
  <text x="300" y="695" text-anchor="middle" class="endpoint-title">Real-time Features</text>
  
  <text x="80" y="715" class="text">• WebSocket connections for live property updates</text>
  <text x="80" y="730" class="text">• Push notifications for new properties matching saved searches</text>
  <text x="80" y="745" class="text">• Real-time chat with agents</text>
  <text x="80" y="760" class="text">• Live property view counts and analytics</text>
  
  <!-- Backend Section -->
  <rect x="600" y="60" width="400" height="800" class="backend-box" rx="10"/>
  <text x="800" y="85" text-anchor="middle" class="section-title">Backend Controllers & Services</text>
  
  <!-- Auth Controller -->
  <rect x="620" y="100" width="180" height="120" class="endpoint-box" rx="5"/>
  <text x="710" y="115" text-anchor="middle" class="endpoint-title">Auth Controller</text>
  
  <text x="630" y="135" class="text">• JWT token generation</text>
  <text x="630" y="150" class="text">• Password hashing (bcrypt)</text>
  <text x="630" y="165" class="text">• 2FA setup & verification</text>
  <text x="630" y="180" class="text">• Email verification</text>
  <text x="630" y="195" class="text">• Session management</text>
  <text x="630" y="210" class="text">• Rate limiting</text>
  
  <!-- Property Controller -->
  <rect x="820" y="100" width="160" height="160" class="endpoint-box" rx="5"/>
  <text x="900" y="115" text-anchor="middle" class="endpoint-title">Property Controller</text>
  
  <text x="830" y="135" class="text">• CRUD operations</text>
  <text x="830" y="150" class="text">• Search & filtering</text>
  <text x="830" y="165" class="text">• Image management</text>
  <text x="830" y="180" class="text">• Analytics tracking</text>
  <text x="830" y="195" class="text">• Recommendations</text>
  <text x="830" y="210" class="text">• Bulk operations</text>
  <text x="830" y="225" class="text">• Status management</text>
  <text x="830" y="240" class="text">• Tour scheduling</text>
  <text x="830" y="255" class="text">• Market insights</text>
  
  <!-- User Controller -->
  <rect x="620" y="240" width="180" height="120" class="endpoint-box" rx="5"/>
  <text x="710" y="255" text-anchor="middle" class="endpoint-title">User Controller</text>
  
  <text x="630" y="275" class="text">• Profile management</text>
  <text x="630" y="290" class="text">• Avatar upload</text>
  <text x="630" y="305" class="text">• Dashboard data</text>
  <text x="630" y="320" class="text">• Browsing history</text>
  <text x="630" y="335" class="text">• Preferences</text>
  <text x="630" y="350" class="text">• Account deletion</text>
  
  <!-- Other Controllers -->
  <rect x="620" y="380" width="360" height="200" class="endpoint-box" rx="5"/>
  <text x="800" y="395" text-anchor="middle" class="endpoint-title">Additional Controllers</text>
  
  <text x="630" y="415" class="text">Favorite Controller:</text>
  <text x="630" y="430" class="small-text">• Add/remove favorites • Get user favorites</text>
  
  <text x="630" y="450" class="text">Inquiry Controller:</text>
  <text x="630" y="465" class="small-text">• Property inquiries • Agent contact • Email notifications</text>
  
  <text x="630" y="485" class="text">Contact Controller:</text>
  <text x="630" y="500" class="small-text">• General contact forms • Support tickets</text>
  
  <text x="630" y="520" class="text">File Controller:</text>
  <text x="630" y="535" class="small-text">• Image uploads • File validation • Storage management</text>
  
  <text x="630" y="555" class="text">Notification Controller:</text>
  <text x="630" y="570" class="small-text">• Push notifications • Email campaigns • SMS alerts</text>
  
  <!-- Services Layer -->
  <rect x="620" y="600" width="360" height="180" class="endpoint-box" rx="5"/>
  <text x="800" y="615" text-anchor="middle" class="endpoint-title">Business Logic Services</text>
  
  <text x="630" y="635" class="text">• authService - Authentication logic</text>
  <text x="630" y="650" class="text">• propertyService - Property business rules</text>
  <text x="630" y="665" class="text">• userService - User management</text>
  <text x="630" y="680" class="text">• emailService - Email templates & sending</text>
  <text x="630" y="695" class="text">• smsService - SMS notifications (Twilio)</text>
  <text x="630" y="710" class="text">• fileService - File handling & validation</text>
  <text x="630" y="725" class="text">• cacheService - Redis caching</text>
  <text x="630" y="740" class="text">• geocodingService - Address to coordinates</text>
  <text x="630" y="755" class="text">• notificationService - Push notifications</text>
  
  <!-- Database Section -->
  <rect x="1050" y="60" width="300" height="800" class="database-box" rx="10"/>
  <text x="1200" y="85" text-anchor="middle" class="section-title">Database Schema</text>
  
  <!-- Users Table -->
  <rect x="1070" y="100" width="260" height="120" class="endpoint-box" rx="5"/>
  <text x="1200" y="115" text-anchor="middle" class="endpoint-title">users</text>
  
  <text x="1080" y="135" class="small-text">• id, email, password_hash</text>
  <text x="1080" y="150" class="small-text">• first_name, last_name, phone</text>
  <text x="1080" y="165" class="small-text">• avatar_url, role, status</text>
  <text x="1080" y="180" class="small-text">• email_verified, two_fa_enabled</text>
  <text x="1080" y="195" class="small-text">• created_at, updated_at</text>
  <text x="1080" y="210" class="small-text">• last_login, preferences</text>
  
  <!-- Properties Table -->
  <rect x="1070" y="240" width="260" height="160" class="endpoint-box" rx="5"/>
  <text x="1200" y="255" text-anchor="middle" class="endpoint-title">properties</text>
  
  <text x="1080" y="275" class="small-text">• id, title, description</text>
  <text x="1080" y="290" class="small-text">• price, currency, property_type</text>
  <text x="1080" y="305" class="small-text">• bedrooms, bathrooms, area</text>
  <text x="1080" y="320" class="small-text">• location, latitude, longitude</text>
  <text x="1080" y="335" class="small-text">• images, features, status</text>
  <text x="1080" y="350" class="small-text">• owner_id, agent_id</text>
  <text x="1080" y="365" class="small-text">• views, created_at, updated_at</text>
  <text x="1080" y="380" class="small-text">• featured, verified</text>
  <text x="1080" y="395" class="small-text">• seo_title, seo_description</text>
  
  <!-- Other Tables -->
  <rect x="1070" y="420" width="260" height="200" class="endpoint-box" rx="5"/>
  <text x="1200" y="435" text-anchor="middle" class="endpoint-title">Additional Tables</text>
  
  <text x="1080" y="455" class="text">favorites:</text>
  <text x="1080" y="470" class="small-text">• user_id, property_id, created_at</text>
  
  <text x="1080" y="490" class="text">inquiries:</text>
  <text x="1080" y="505" class="small-text">• id, property_id, user_id, message</text>
  <text x="1080" y="520" class="small-text">• contact_info, status, created_at</text>
  
  <text x="1080" y="540" class="text">browsing_sessions:</text>
  <text x="1080" y="555" class="small-text">• id, user_id, property_id, duration</text>
  <text x="1080" y="570" class="small-text">• actions, created_at</text>
  
  <text x="1080" y="590" class="text">notifications:</text>
  <text x="1080" y="605" class="small-text">• id, user_id, type, title, message</text>
  <text x="1080" y="620" class="small-text">• read, created_at</text>
  
  <!-- Indexes & Performance -->
  <rect x="1070" y="640" width="260" height="120" class="endpoint-box" rx="5"/>
  <text x="1200" y="655" text-anchor="middle" class="endpoint-title">Performance Optimization</text>
  
  <text x="1080" y="675" class="text">Indexes:</text>
  <text x="1080" y="690" class="small-text">• properties(location, price, type)</text>
  <text x="1080" y="705" class="small-text">• users(email), favorites(user_id)</text>
  
  <text x="1080" y="725" class="text">Caching:</text>
  <text x="1080" y="740" class="small-text">• Redis for search results</text>
  <text x="1080" y="755" class="small-text">• Property recommendations</text>
  
  <!-- Connection Lines -->
  
  <!-- Frontend to Backend -->
  <line x1="550" y1="200" x2="600" y2="200" class="post-line" marker-end="url(#arrow)"/>
  <line x1="550" y1="250" x2="600" y2="250" class="get-line" marker-end="url(#arrow)"/>
  <line x1="550" y1="400" x2="600" y2="400" class="put-line" marker-end="url(#arrow)"/>
  <line x1="550" y1="600" x2="600" y2="600" class="delete-line" marker-end="url(#arrow)"/>
  
  <!-- Backend to Database -->
  <line x1="1000" y1="300" x2="1050" y2="300" class="data-flow" marker-end="url(#arrow)"/>
  <line x1="1000" y1="500" x2="1050" y2="500" class="data-flow" marker-end="url(#arrow)"/>
  <line x1="1000" y1="700" x2="1050" y2="700" class="data-flow" marker-end="url(#arrow)"/>
  
  <!-- Legend -->
  <rect x="50" y="900" width="1300" height="80" fill="#f9fafb" stroke="#e5e7eb" stroke-width="1" rx="5"/>
  <text x="700" y="920" text-anchor="middle" class="section-title">HTTP Methods & Data Flow</text>
  
  <rect x="100" y="930" width="15" height="3" class="get-line"/>
  <text x="125" y="935" class="method-get">GET</text>
  <text x="155" y="935" class="small-text">Read operations</text>
  
  <rect x="280" y="930" width="15" height="3" class="post-line"/>
  <text x="305" y="935" class="method-post">POST</text>
  <text x="340" y="935" class="small-text">Create operations</text>
  
  <rect x="460" y="930" width="15" height="3" class="put-line"/>
  <text x="485" y="935" class="method-put">PUT</text>
  <text x="515" y="935" class="small-text">Update operations</text>
  
  <rect x="630" y="930" width="15" height="3" class="delete-line"/>
  <text x="655" y="935" class="method-delete">DELETE</text>
  <text x="705" y="935" class="small-text">Delete operations</text>
  
  <rect x="820" y="930" width="15" height="3" class="data-flow"/>
  <text x="845" y="935" class="text">Database queries</text>
  
  <text x="100" y="955" class="small-text">• All API endpoints use JWT authentication • Rate limiting applied to prevent abuse</text>
  <text x="100" y="970" class="small-text">• Request validation using Joi schemas • Error handling with consistent response format</text>
  
</svg>